<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:title" content="ClaraCS" />
    <meta property="og:description" content="ClaraCS의 메인 페이지입니다." />
    <meta property="og:image" content="" />
    <title>ClaraCS – 지능형 CS 데이터 분석·인사이트 플랫폼</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
<div class="app">
  <!-- 사이드바 -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo"></div>
      <h1>ClaraCS – 분석&인사이트</h1>
    </div>
    <nav class="nav">
      <a href="#" class="active"><span class="dot"></span><span>대시보드</span><span class="badge ok">MVP</span></a>
      <a href="#upload"><span class="dot"></span><span>데이터 업로드</span><span></span></a>
      <a href="#mapping"><span class="dot"></span><span>컬럼 매핑</span><span></span></a>
      <a href="#classify"><span class="dot"></span><span>자동 분류</span><span></span></a>
      <a href="#report"><span class="dot"></span><span>분석 리포트</span><span></span></a>
      <a href="#export"><span class="dot"></span><span>리포트 내보내기</span><span></span></a>
      <a href="#help"><span class="dot"></span><span>설정 · 도움말</span><span></span></a>
    </nav>
    <div class="helper">
      <div><strong>프로젝트명</strong><br/>지능형 CS 데이터 분석·인사이트 플랫폼 구축</div>
      <div style="margin-top:10px;" class="tip">※ 이 목업은 HTML/CSS만으로 구성된 정적 화면입니다. 상호작용/데이터는 JS 연동 시 동작합니다.</div>
    </div>
  </aside>

  <!-- 메인 -->
  <main class="main">

    <!-- 대시보드 개요 -->
    <section class="section" id="dashboard">
      <div class="head">
        <h2>대시보드 개요</h2>
        <div class="toolbar">
          <button class="btn ghost">기간: 최근 30일</button>
          <button class="btn">필터</button>
          <button class="btn primary">새 보고서 생성</button>
        </div>
      </div>
      <div class="body">
        <div class="grid cols-3">
          <div class="card kpi"><div class="label">총 접수 건수</div><div class="value">12,483</div><div class="trend">▲ 8.2% (전월 대비)</div></div>
          <div class="card kpi"><div class="label">자동 분류 정확도(샘플)</div><div class="value">92.4%</div><div class="trend" style="color:var(--warn)">→ 모델 재학습 권장</div></div>
          <div class="card kpi"><div class="label">재문의율(샘플)</div><div class="value">7.3%</div><div class="trend">▼ 1.1%p</div></div>
        </div>
        <div class="grid cols-2" style="margin-top:16px;">
          <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
              <strong>유형별 발생 추이(샘플)</strong>
              <div class="legend"><div class="item"><span class="dot"></span>배송</div><div class="item"><span class="dot" style="background:#3ddc97"></span>환불</div><div class="item"><span class="dot" style="background:#ffb020"></span>품질</div></div>
            </div>
            <div class="chart-box">차트 영역 (라인)</div>
          </div>
          <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
              <strong>우선순위 분포(샘플)</strong>
              <span class="badge warn">업데이트 필요</span>
            </div>
            <div class="chart-box">차트 영역 (도넛)</div>
          </div>
        </div>
      </div>
    </section>

    <!-- 업로드 -->
    <section class="section" id="upload">
      <div class="head">
        <h2>데이터 업로드 (.xlsx / .csv / .xls)</h2>
        <div class="toolbar">
          <label style="display:inline-flex;align-items:center;gap:4px;">
            <input type="checkbox" id="select_all" />
            전체 선택
          </label>
          <button id="delete_file" class="btn">삭제</button>
          <button id="upload_file" class="btn save">파일 첨부</button>
          <input type="file" id="file_input" style="display: none;" multiple accept=".csv, .xlsx, .xls" />
        </div>
      </div>
      <div class="body">
        <div class="uploader">
          <br/>
          <div class="title">여기에 파일을 끌어다 놓거나, 상단의 파일 첨부를 클릭하세요.</div>
          <div class="desc" style="margin-top:6px;">필수 컬럼 예시: 접수일, 채널, 고객ID/이메일, 본문, 담당자, 카테고리(선택)</div>
          <div class="file_list"></div>
          <div id="upload_summary" class="upload-summary"></div>
        </div>
        <p class="tip" style="margin-top:10px;">※ 권장 사항 : 각 채널당 파일 수는 3~5개, 총 용량 15MB 이내로 업로드해 주세요.</p>
        <div class="card" style="margin-top:16px;">
          <strong>미리보기(상위 5행)</strong>
          <table class="table" style="margin-top:8px;">
            <thead>
              <tr>
                <th>created_at</th><th>customer_ID</th><th>channel</th><th>product_ID</th><th>category</th><th>message</th><th>status</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>2025-08-01</td><td>cust_1023</td><td>게시판</td><td>MBP16-M3-1TB-SIL</td><td>배송 지연</td><td>	주문한 상품이 아직 도착을 안 했어요. 배송...</td><td>신규</td></tr>
              <tr><td>2025-08-02</td><td>cust_3381</td><td>챗봇</td><td>MBA13-M2-256GB-MID</td><td>환불 문의</td><td>결제 취소가 안돼요. 지난주에 요청...</td><td>진행중</td></tr>
              <tr><td>2025-08-02</td><td>cust_9912</td><td>전화</td><td>MBP14-M3-512GB-SPG</td><td>파손 수령</td><td>박스가 찢어져서 제품 외부에 흠집이...</td><td>신규</td></tr>
              <tr><td>2025-08-03</td><td>cust_1277</td><td>SNS<td>MBA13-M2-256GB-MID</td></td><td>품질 불만</td><td>색상이 사진과 달라요. 화면에서 본 색과...</td><td>완료</td></tr>
              <tr><td>2025-08-03</td><td>cust_6620</td><td>게시판</td><td>MBA15-M3-512GB-STAR</td><td>AS 문의</td><td>작동이 중간에 멈춤. 전원 버튼을 눌러도...</td><td>신규</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- 컬럼 매핑 -->
    <section class="section" id="mapping">
      <div class="head">
        <h2>컬럼 매핑</h2>
        <div class="toolbar">
          <button class="btn save">매핑 저장</button>
        </div>
      </div>
      <div class="body grid cols-2">
        <div class="card">
          <strong>원본 컬럼</strong>
          <button id="column_setting" class="btn save">컬럼 저장</button> 
          <button id="column_reset" class="btn">초기화</button>
          <div class="grid" style="margin-top:23px; clear:both;">
            <div class="mapping-grid"><input class="input" value="created_at" /><span style="text-align:center; color:var(--muted)">→</span><select class="select"><option>접수일</option>
            <div class="mapping-grid"><input class="input" value="customer_ID" /><span style="text-align:center; color:var(--muted)">→</span><select class="select"><option>고객ID/이메일(공용)</option><option>고객ID</option><option>이메일</option></select></div>
            <div class="mapping-grid"><input class="input" value="channel" /><span style="text-align:center; color:var(--muted)">→</span><select class="select"><option>채널(공용)</option><option>게시판</option><option>전화</option><option>이메일</option><option>네이버 톡톡</option><option>카카오톡</option></select></div>
            <div class="mapping-grid"><input class="input" value="product_ID" /><span style="text-align:center; color:var(--muted)">→</span><select class="select"><option>상품ID(SKU)</option></select></div>
            <div class="mapping-grid"><input class="input" value="category" /><span style="text-align:center; color:var(--muted)">→</span><select class="select"><option>카테고리</option></select></div>
            <div class="mapping-grid"><input class="input" value="message" /><span style="text-align:center; color:var(--muted)">→</span><select class="select"><option>문의 내용(공용)</option><option>제목</option><option>본문</option></select></div>
            <div class="mapping-grid"><input class="input" value="status" /><span style="text-align:center; color:var(--muted)">→</span><select class="select"><option>처리 상태</option></select></div>
          </div>
          <p class="tip" style="margin-top:8px;">※ 매핑 템플릿을 저장해두면 다음 업로드부터 자동 적용</p>
        </div>
        <div class="card">
          <strong>유효성/정합성 체크</strong>
          <ul class="subtle">
            <li>필수 컬럼 누락: <span class="badge danger">본문</span> 2열에서 공란 5건</li>
            <li>날짜 형식 불일치: <span class="badge warn">접수일</span> 3건(YYYY-MM-DD 권장)</li>
            <li>개인정보 마스킹: <span class="badge ok">고객ID/이메일</span> 자동 마스킹 설정</li>
          </ul>
          <div class="toolbar" style="margin-top:10px;">
            <button id="camelCase" class="btn">정제 실행</button>
          </div>
        </div>
      </div>
    </section>

    <!-- 자동 분류 -->
<section class="section" id="classify">
  <div class="head">
    <h2>자동 분류</h2>
    <div class="toolbar">
      <!-- <button class="btn">규칙 편집</button> -->
      <!-- <button class="btn">모델 교체</button> -->
      <!-- 마지막 분류 시각 표시 -->
      <span id="last-run-at" class="small muted" style="margin-left:8px;">
       마지막 분류 : -
      </span>
      <button id="btn-reset-classify" class="btn ghost" onclick="window.resetClassification && window.resetClassification()">
        초기화
      </button>
      <!-- 버튼에 id 부여: JS가 클릭 이벤트를 바인딩 -->
      <button id="btn-run-classify" class="btn primary" onclick="window.runClassification && window.runClassification()">
        분류 실행
      </button>
    </div>
  </div>

  <div class="body">
    <!-- 여기부터 그리드 컨테이너 -->
    <div class="classify-grid">
      
      <!-- 1x1 : 카테고리별 분류 결과 -->
      <div class="card card--category">
        <strong>카테고리별 분류 결과</strong>
        <table class="table" style="margin-top:8px;">
          <thead>
            <tr><th>카테고리</th><th class="right">건수</th><th class="right">비율</th><th>예시 키워드</th></tr>
          </thead>
          <tbody id="categoryTableBody">
            <tr><td colspan="4">[분류 실행]을 눌러 데이터를 불러오세요</td></tr>
          </tbody>
        </table>
      </div>

      <!-- 1x2 + 2x2 : 채널별 분류 결과(오른쪽 열 전체를 세로로 차지) -->
      <div class="card card--channels">
        <div class="channels-head">
          <strong>채널별 분류 결과</strong>
          <div class="legend sticky">
            <div class="item"><span class="dot" style="background:#ff4d4f"></span>배송</div>
            <div class="item"><span class="dot" style="background:#ffa940"></span>환불/취소</div>
            <div class="item"><span class="dot" style="background:#3ddc97"></span>품질/하자</div>
            <div class="item"><span class="dot" style="background:#ffd666"></span>AS/설치</div>
            <div class="item"><span class="dot" style="background:#9aa0a6"></span>기타</div>
          </div>
        </div>
        <div id="channelCards" class="channel-grid scroll-y"><!-- JS가 카드 렌더링 --></div>
      </div>

      <!-- 2x1 : 자동 분류 정확도/신뢰도 -->
      <div class="card card--reliability">
        <strong>자동 분류 정확도/신뢰도</strong>
        <div id="reliabilityBox" class="chart-box tall center">-</div>
        <p class="tip" style="margin-top:8px;">train/val/test, Macro-F1, Micro-F1, Accuracy</p>
      </div>

      <!-- 3x1 + 3x2 : 티켓 목록(하단 전체 폭) -->
      <div class="card card--tickets">
        <strong>티켓 목록</strong>
        <table class="table" style="margin-top:8px;">
          <thead>
            <tr>
              <th>접수일</th><th>채널</th><th>내용</th><th>카테고리</th><th>키워드</th><th class="right">중요도</th>
            </tr>
          </thead>
          <tbody id="ticketTableBody">
            <tr><td colspan="6">-</td></tr>
          </tbody>
        </table>
      </div>

    </div>
    <!-- 그리드 끝 -->
     
  </div>
</section>

    <!-- 분석 리포트 -->
    <section class="section" id="report">
      <div class="head">
        <h2>분석 리포트 (요약/인사이트)</h2>
        <div class="toolbar">
          <button class="btn">템플릿 선택</button>
          <button class="btn primary">리포트 생성</button>
        </div>
      </div>
      <div class="body grid cols-2">
        <div class="card">
          <strong>채널별 추이</strong>
          <div class="chart-box">차트 영역 (스택 바)</div>
        </div>
        <div class="card">
          <strong>데이터 요약</strong>
          <ul class="subtle">
          </ul>
        </div>
        <div class="card">
          <strong>인사이트 도출</strong>
          <ol class="subtle">
          </ol>
        </div>
        <div class="card">
          <strong>솔루션 제안</strong>
          <ul class="subtle">
            <!-- 솔루션이 여기에 동적으로 생성됩니다 -->
          </ul>
        </div>
      </div>
      <div style="text-align: center;">
      <button class="btn primary">리포트 내보내기(pdf)</button>
      </div>
    </section>

    <!-- 내보내기/공유 -->
    <section class="section" id="export">
      <div class="head">
        <h2>리포트 내보내기 · 공유</h2>
        <div class="toolbar">
          <button class="btn">CSV</button>
          <button class="btn">PDF</button>
          <button class="btn">PPT</button>
          <button class="btn primary">대시보드 공유 링크 생성</button>
        </div>
      </div>
      <div class="body">
        <div class="grid cols-2">
          <div class="card">
            <strong>내보내기 프리셋</strong>
            <ul class="subtle">
              <li>경영진용: 요약 + 핵심 지표 5개 + 권고안</li>
              <li>운영팀용: 카테고리 상세 + 티켓 샘플 100건</li>
              <li>개발/품질팀용: 루트코즈 + SKU/지역 매핑</li>
            </ul>
          </div>
          <div class="card">
            <strong>버전/이력</strong>
            <table class="table" style="margin-top:8px;">
              <thead><tr><th>버전</th><th>생성일</th><th>생성자</th><th>설명</th></tr></thead>
              <tbody>
                <tr><td>v0.3</td><td>2025-08-05</td><td>KMH</td><td>권고안 섹션 추가</td></tr>
                <tr><td>v0.2</td><td>2025-08-02</td><td>KMH</td><td>카테고리 추이 업데이트</td></tr>
                <tr><td>v0.1</td><td>2025-08-01</td><td>KMH</td><td>초기 템플릿</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- 설정/도움말 -->
    <section class="section" id="help">
      <div class="head">
        <h2>설정 · 도움말</h2>
        <div class="toolbar">
          <button class="btn">마스킹 규칙</button>
          <button class="btn">분류 카테고리 관리</button>
          <button class="btn">SLA 지표</button>
          <button class="btn primary">저장</button>
        </div>
      </div>
      <div class="body grid cols-3">
        <div class="card">
          <strong>보안/프라이버시</strong>
          <p class="subtle">개인정보 컬럼: 이메일/전화 → 자동 마스킹 / 암호화 보관</p>
          <label class="subtle" style="display:block; margin-top:8px;">마스킹 예시</label>
          <input class="input" value="john****@example.com, 010-12**-56**" />
        </div>
        <div class="card">
          <strong>카테고리 세트</strong>
          <p class="subtle">표준 카테고리(배송/환불/품질/AS/기타) + 사용자 정의</p>
          <input class="input" placeholder="예: 교환/반품" />
          <div class="toolbar" style="margin-top:8px;"><button class="btn">추가</button><button class="btn ghost">초기화</button></div>
        </div>
        <div class="card">
          <strong>도움말</strong>
          <ul class="subtle">
            <li>1) 업로드 → 2) 매핑 → 3) 분류 → 4) 리포트 → 5) 내보내기</li>
            <li>샘플 데이터로 먼저 리포트 흐름을 검증하세요.</li>
            <li>실제 동작은 JS/백엔드 연동 시 활성화됩니다.</li>
          </ul>
        </div>
      </div>
    </section>

  </main>
</div>
<script type="text/javascript" src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/common.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/upload.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/report.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/auto_classify.js') }}"></script>
</body>
</html>